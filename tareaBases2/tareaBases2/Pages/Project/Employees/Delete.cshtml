@page
@using System.Data.SqlClient
@using System.Data;
@{
    try
    {
        String id = Request.Query["id"];
        String idUser = Request.Query["idUser"];

        string connectionString = "Data Source=LAPTOP-K8CP12F2;Initial Catalog=tarea2" +
                                    ";Integrated Security=True;Encrypt=False";
        using (SqlConnection sqlConnection = new SqlConnection(connectionString))
        {
            sqlConnection.Open();
            // Crear un comando SQL para llamar al procedimiento almacenado
            using (SqlCommand command = new SqlCommand("eliminarEmpleado", sqlConnection))
            {
                // Especificar que el comando es un procedimiento almacenado
                command.CommandType = CommandType.StoredProcedure;

                // Parámetros de entrada
                command.Parameters.AddWithValue("@id", id);

                // Parámetro de salida para el código de resultado
                SqlParameter outParam = command.Parameters.Add("@OutResulTCode", SqlDbType.Int);
                outParam.Direction = ParameterDirection.Output;

                // Ejecutar el procedimiento almacenado
                command.ExecuteNonQuery();

                // Obtener el valor del parámetro de salida (código de resultado)
                int resultCode = Convert.ToInt32(outParam.Value);
                Console.WriteLine("Código de resultado: " + resultCode);
            }
            /*
            string tipoEvento = "Login No Exitoso";
            string message = "Empleado con ValorDocumentoIdentidad ya existe en inserción." +
                "Cedula = " + infoEmpleyee.Identificacion +
                " Nombre = " + infoEmpleyee.Nombre +
                " Puesto = " + infoEmpleyee.idPuesto;
                */
            sqlConnection.Close();
        }
    }
    catch(Exception ex)
    {

    }
    
    Response.Redirect("/Project/Employees/Index?idUser=@Model.idUser");
}
